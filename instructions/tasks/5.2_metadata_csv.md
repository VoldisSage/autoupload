# Task 5.2 – Metadata store: append to CSV log

## Description
Extend the metadata store to maintain a global CSV file (`data/videos_metadata.csv`) containing a summary row for each processed video.

## Definition of Done
- In `src/services/metadataStore.ts`, implement a function:
  - `appendToCsv(metadata: YoutubeMetadata, ctx: StreamContext): Promise<void>` (or sync)
- The CSV:
  - Lives at `data/videos_metadata.csv`.
  - If the file does not exist, a header row is written first with columns:
    - `video_id,twitch_stream_id,youtube_video_id,date,channel_name,twitch_title,youtube_title,description_short,game,language,tags,duration_seconds,model,prompt_version,created_at`
  - Appends one row per video with values derived from `metadata` and `ctx`:
    - `description_short` = first ~160 chars of `description` with newlines removed.
    - `tags` joined by `|`.
    - `created_at` = current ISO timestamp at the time of writing.
  - Properly escapes commas, quotes and newlines (valid CSV).
- No invalid CSV lines are produced, even when values contain commas or quotes.

## Tests
- Create `dev/testMetadataCsv.ts` that:
  - Calls `appendToCsv` 2–3 times with fake metadata/context.
- Add npm script:
  - `"dev:test-csv": "ts-node dev/testMetadataCsv.ts"` or equivalent.
- Run `npm run dev:test-csv` and verify:
  - `data/videos_metadata.csv` exists.
  - It contains a header plus multiple data rows.
  - The file opens correctly in a spreadsheet tool (Excel, LibreOffice, etc.) without corrupt columns.

## Files to create / modify
- `src/services/metadataStore.ts` (extend with CSV logic)
- `dev/testMetadataCsv.ts`
- `package.json` (add dev test script)
